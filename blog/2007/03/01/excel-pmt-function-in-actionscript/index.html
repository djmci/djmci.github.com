<!DOCTYPE html>
<!--[if IE 7]>
<html id="ie7" dir="ltr" lang="en-US">
<![endif]-->
<!--[if IE 8]>
<html id="ie8" dir="ltr" lang="en-US">
<![endif]-->
<!--[if IE 9]>
<html id="ie9" dir="ltr" lang="en-US">
<![endif]-->
<!--[if !(IE 7) | !(IE 8) | !(IE 9)  ]><!-->
<html dir="ltr" lang="en-US">
<!--<![endif]-->
<head>
<base href="/blog" />

<meta charset="UTF-8" />
<title>Excel PMT function in Actionscript | shiftperception.com</title>

<link rel="stylesheet" href="/blog/wp-content/themes/pink-touch-sp/style.css" type="text/css" media="screen" />

<meta name='robots' content='noindex,nofollow' />



<link rel='stylesheet' id='arvo-css'  href='http://fonts.googleapis.com/css?family=Arvo%3A400%2C700&#038;ver=3.3.1' type='text/css' media='all' />
<script type='text/javascript' src='/blog/wp-includes/js/comment-reply.js?ver=20090102'></script>

 

<link rel='next' title='Download simulator' href='/blog/2007/03/14/download-simulator/' />

<link rel='canonical' href='/blog/2007/03/01/excel-pmt-function-in-actionscript/' />
<link rel='shortlink' href='/blog/?p=86' />
</head>

<body class="single single-post postid-86 single-format-standard">
	<div id="wrapper">
		<div id="navigation">
			<div class="wrapper wide-wrapper clearfix">
				<div id="nav-menu" class="menu-postacrds-container"><ul id="menu-postacrds" class="menu"><li id="menu-item-893" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-893"><a href="/">Home</a></li>
<li id="menu-item-892" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-892"><a href="/blog/projects/">Projects</a></li>
<li id="menu-item-884" class="menu-item menu-item-type-taxonomy menu-item-object-category current-post-ancestor current-menu-parent current-post-parent menu-item-884"><a href="/blog/category/postacrds/">Postcards</a></li>
<li id="menu-item-886" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-886"><a href="/blog/category/development/">Development</a></li>
<li id="menu-item-887" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-887"><a href="/blog/category/interaction/">Interaction</a></li>
<li id="menu-item-888" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-888"><a href="/blog/category/design/">Design</a></li>
<li id="menu-item-889" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-889"><a href="/blog/category/thoughts/">Thoughts</a></li>
<li id="menu-item-890" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-890"><a href="/blog/category/desktops/">Desktops</a></li>
<li id="menu-item-891" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-891"><a href="/blog/category/essays/">Essays</a></li>
</ul></div>			</div>
		</div><!-- /#navigation -->
		<div id="navigation-frill"></div>

		<div id="header">
			<p class="blog-tag"><a href="/blog/" title="shiftperception.com" rel="home">shiftperception.com</a></p>

			<div id="description">
				<p></p>
			</div>
		</div><!-- /#header -->

		<div id="content">


	
<div id="post-86" class="post-86 post type-post status-publish format-standard hentry category-postacrds tag-actionscript tag-red-ant-design">
		<div class="date">
		<a href="/blog/2007/03/01/excel-pmt-function-in-actionscript/" title="Permalink to Excel PMT function in Actionscript" rel="bookmark">
							<p><span class="day">01</span>Mar / 2007</p>
					</a>
	</div>
	
	<div class="content">
		<h1 class="entry-title"><a href="/blog/2007/03/01/excel-pmt-function-in-actionscript/" title="Permalink to Excel PMT function in Actionscript" rel="bookmark">Excel PMT function in Actionscript</a></h1>

		<div class="entry-content">
			<p>Just thought id share this as it will come in useful for someone in the future. Ever wanted to use the PMT function from Excel in Flash? Well, after some digging, and after some modifications, here is it.<br />
<code><br />
PMT = function(r,np,pv,fv,t) {<br />
    /*<br />
       r = the percentage rate of the loan. (decimal: 8% = 0.08)<br />
       np  = number of monthly payments (integer)<br />
       pv = present value or principal of the loan (decimal)<br />
       fv = future value of the loan (after payments) (decimal)<br />
       t = paid before or after (0/1)<br />
                                */<br />
&nbsp;&nbsp;var vPow = Math.pow( ( 1 + r ), np );<br />
&nbsp;&nbsp;var vT = (t == 0) ? r : ( r /( 1 + r ) );<br />
&nbsp;&nbsp;return ( (vPow * pv) - fv ) / (vPow - 1) * vT;<br />
 }<br />
</code></p>
<p>Don&#8217;t say I never give you anything! (Thanks OJ for your hint on consolidating the last 2 lines into 1)</p>
								</div><!-- .entry-content -->
	</div><!-- .content -->

		<div class="info">
					<p class="category-list">
				Posted in <a href="/blog/category/postacrds/" title="View all posts in Postacrds" rel="category tag">Postacrds</a>			</p>
		
		<p class="tag-list">Tags: <a href="/blog/tag/actionscript/" rel="tag">Actionscript</a>, <a href="/blog/tag/red-ant-design/" rel="tag">Red Ant Design</a></p>
		<p>
			<span class="permalink"><a href="/blog/2007/03/01/excel-pmt-function-in-actionscript/" title="Permalink to Excel PMT function in Actionscript" rel="bookmark">Permalink</a></span>

							<span class="notes"><a href="/blog/2007/03/01/excel-pmt-function-in-actionscript/#comments" title="Comment on Excel PMT function in Actionscript"><span class="dsq-postid" rel="86 /blog/2007/03/01/excel-pmt-function-in-actionscript/">5 Comments</span></a></span>
					</p>

			</div>
</div><!-- /.post -->
	<div class="pagination">
		<p class="clearfix">
			<a href="/blog/2007/02/16/accidental-unicycle/" rel="prev"><span class="older"><span class="meta-nav">&larr;</span> Previous post</span></a>			<a href="/blog/2007/03/14/download-simulator/" rel="next"><span class="newer">Next post <span class="meta-nav">&rarr;</span></span></a>		</p>
	</div>

	
<div id="disqus_thread">
                    <div id="dsq-content">


            <ul id="dsq-comments">
                    <li class="comment even thread-even depth-1" id="dsq-comment-2957">
        <div id="dsq-comment-header-2957" class="dsq-comment-header">
            <cite id="dsq-cite-2957">
http://rant.blackapache.net/                <span id="dsq-author-user-2957">OJ</span>
            </cite>
        </div>
        <div id="dsq-comment-body-2957" class="dsq-comment-body">
            <div id="dsq-comment-message-2957" class="dsq-comment-message"><p>I reckon that we could make that a <em>lot</em> more obfuscated than that! How about this:<br />
<code>CYRIL = function(jane,doris,bert,betty,mavis) {<br />
  /*<br />
  jane = the percentage rate of the loan. (decimal: 8% = 0.08)<br />
  doris = number of monthly payments (integer)<br />
  bert = present value or principal of the loan (decimal)<br />
  betty = future value of the loan (after payments) (decimal)<br />
  mavis = paid before or after (0/1)<br />
  */<br />
&nbsp;&nbsp;var bernie = 1;<br />
&nbsp;&nbsp;var alf = Math.pow((bernie+jane ),doris);<br />
&nbsp;&nbsp;return ((alf*bert)-betty)/(alf-bernie)*((mavis==0)?jane:(jane/(bernie+jane)));<br />
}</code></p>
</div>
        </div>
    </li>

    </li>
    <li class="comment byuser comment-author-admin bypostauthor odd alt thread-odd thread-alt depth-1" id="dsq-comment-2958">
        <div id="dsq-comment-header-2958" class="dsq-comment-header">
            <cite id="dsq-cite-2958">
                <span id="dsq-author-user-2958">dan</span>
            </cite>
        </div>
        <div id="dsq-comment-body-2958" class="dsq-comment-body">
            <div id="dsq-comment-message-2958" class="dsq-comment-message"><p>Well, yes, we could have couldn&#8217;t we?!</p>
<p>Why not in the comments for the function give all your characters a bio <img src='/blog/wp-includes/images/smilies/icon_smile.gif' alt=':)' class='wp-smiley' /> </p>
<p>Ive seen worse before &#8211; as have you <img src='/blog/wp-includes/images/smilies/icon_razz.gif' alt=':P' class='wp-smiley' /> </p>
</div>
        </div>
    </li>

    </li>
    <li class="comment even thread-even depth-1" id="dsq-comment-3281">
        <div id="dsq-comment-header-3281" class="dsq-comment-header">
            <cite id="dsq-cite-3281">
                <span id="dsq-author-user-3281">Guu</span>
            </cite>
        </div>
        <div id="dsq-comment-body-3281" class="dsq-comment-body">
            <div id="dsq-comment-message-3281" class="dsq-comment-message"><p>Thank you a lot!!!</p>
</div>
        </div>
    </li>

    </li>
    <li class="comment odd alt thread-odd thread-alt depth-1" id="dsq-comment-3402">
        <div id="dsq-comment-header-3402" class="dsq-comment-header">
            <cite id="dsq-cite-3402">
                <span id="dsq-author-user-3402">Mike</span>
            </cite>
        </div>
        <div id="dsq-comment-body-3402" class="dsq-comment-body">
            <div id="dsq-comment-message-3402" class="dsq-comment-message"><p>Hey dan!!</p>
<p>Long time no see &#8211; HAPPY BIRTHDAY!!</p>
<p>PMT &#8211; Pre Menstrual Tension?!?!</p>
<p>Now that is a useful calculator &#8211; Now I know when to hide &#8211; thanks!!!</p>
<p>Cheers,<br />
Mike</p>
</div>
        </div>
    </li>

    </li>
    <li class="comment byuser comment-author-admin bypostauthor even thread-even depth-1" id="dsq-comment-3403">
        <div id="dsq-comment-header-3403" class="dsq-comment-header">
            <cite id="dsq-cite-3403">
                <span id="dsq-author-user-3403">dan</span>
            </cite>
        </div>
        <div id="dsq-comment-body-3403" class="dsq-comment-body">
            <div id="dsq-comment-message-3403" class="dsq-comment-message"><p>Hey Mike <img src='/blog/wp-includes/images/smilies/icon_smile.gif' alt=':)' class='wp-smiley' /> </p>
<p>Cheers !! We&#8217;re you looking for a way to calculate PMT (either kind) and stumbled across my blog before realising it was both Darrall and my birthdays today? (And don&#8217;t forget Frodo or Bilbo <img src='/blog/wp-includes/images/smilies/icon_smile.gif' alt=':)' class='wp-smiley' />  )</p>
</div>
        </div>
    </li>

    </li>
            </ul>


        </div>

    </div>

<script type="text/javascript">
/* <![CDATA[ */
    var disqus_url = '/blog/2007/03/01/excel-pmt-function-in-actionscript/';
    var disqus_identifier = '86 /blog/2007/03/01/excel-pmt-function-in-actionscript/';
    var disqus_container_id = 'disqus_thread';
    var disqus_domain = 'disqus.com';
    var disqus_shortname = 'djmci';
    var disqus_title = "Excel PMT function in Actionscript";
        var disqus_config = function () {
        var config = this; // Access to the config object

        /*
           All currently supported events:
            * preData — fires just before we request for initial data
            * preInit - fires after we get initial data but before we load any dependencies
            * onInit  - fires when all dependencies are resolved but before dtpl template is rendered
            * afterRender - fires when template is rendered but before we show it
            * onReady - everything is done
         */

        config.callbacks.preData.push(function() {
            // clear out the container (its filled for SEO/legacy purposes)
            document.getElementById(disqus_container_id).innerHTML = '';
        });
                config.callbacks.onReady.push(function() {
            // sync comments in the background so we don't block the page
            DISQUS.request.get('?cf_action=sync_comments&post_id=86');
        });
                    };
    var facebookXdReceiverPath = '/blog/wp-content/plugins/disqus-comment-system/xd_receiver.htm';
/* ]]> */
</script>

<script type="text/javascript">
/* <![CDATA[ */
    var DsqLocal = {
        'trackbacks': [
        ],
        'trackback_url': "http:\/\/alien.local\/~dan\/shiftperception\/blog\/2007\/03\/01\/excel-pmt-function-in-actionscript\/trackback\/"    };
/* ]]> */
</script>

<script type="text/javascript">
/* <![CDATA[ */
(function() {
    var dsq = document.createElement('script'); dsq.type = 'text/javascript';
    dsq.async = true;
    dsq.src = 'http://' + disqus_shortname + '.' + disqus_domain + '/embed.js?pname=wordpress&pver=2.70';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
})();
/* ]]> */
</script>


		</div><!-- /#content -->
	</div><!-- /#wrapper -->

	<div id="footer-frill"></div>
	<div id="footer">
		<div class="wrapper">
		
<div id="widgets" class="clearfix three">
		<div id="first" class="widget-area">
				<div id="recent-posts-2" class="clearfix widget widget_recent_entries">		<h3 class="widget-title">Recent Posts</h3>		<ul>
				<li><a href="/blog/2009/11/09/experimenting-with-typekit-com/" title="Experimenting with TypeKit.com">Experimenting with TypeKit.com</a></li>
				<li><a href="/blog/2009/09/05/trespassers-will-be-electrocuted/" title="Trespassers will be electrocuted!">Trespassers will be electrocuted!</a></li>
				<li><a href="/blog/2009/07/05/poster-collection-2-agam/" title="Poster Collection &#8211; 2 &#8211; AGAM">Poster Collection &#8211; 2 &#8211; AGAM</a></li>
				<li><a href="/blog/2009/07/05/le-tour-de-adobe/" title="Le Tour de Adobe">Le Tour de Adobe</a></li>
				<li><a href="/blog/2009/06/16/unique-records-in-as3/" title="Unique records in AS3">Unique records in AS3</a></li>
				</ul>
		</div>	</div><!-- #first .widget-area -->
	
		<div id="second" class="widget-area">
		<div id="categories-2" class="clearfix widget widget_categories"><h3 class="widget-title">Categories</h3>		<ul>
	<li class="cat-item cat-item-2"><a href="/blog/category/design/" title="View all posts filed under Design">Design</a>
</li>
	<li class="cat-item cat-item-8"><a href="/blog/category/desktops/" title="View all posts filed under Desktops">Desktops</a>
</li>
	<li class="cat-item cat-item-3"><a href="/blog/category/development/" title="View all posts filed under Development">Development</a>
</li>
	<li class="cat-item cat-item-48"><a href="/blog/category/essays/" title="View all posts filed under Essays">Essays</a>
</li>
	<li class="cat-item cat-item-10"><a href="/blog/category/interaction/" title="View all posts filed under Interaction">Interaction</a>
</li>
	<li class="cat-item cat-item-1"><a href="/blog/category/postacrds/" title="View all posts filed under Postacrds">Postacrds</a>
</li>
	<li class="cat-item cat-item-12"><a href="/blog/category/thoughts/" title="View all posts filed under Thoughts">Thoughts</a>
</li>
		</ul>
</div>	</div><!-- #second .widget-area -->
	
		<div id="third" class="widget-area">
		<div id="archives-3" class="clearfix widget widget_archive"><h3 class="widget-title">Archives</h3>		<select name="archive-dropdown" onchange='document.location.href=this.options[this.selectedIndex].value;'> <option value="">Select Month</option> 	<option value='/blog/2009/11/'> November 2009 &nbsp;(1)</option>
	<option value='/blog/2009/09/'> September 2009 &nbsp;(1)</option>
	<option value='/blog/2009/07/'> July 2009 &nbsp;(2)</option>
	<option value='/blog/2009/06/'> June 2009 &nbsp;(2)</option>
	<option value='/blog/2009/05/'> May 2009 &nbsp;(1)</option>
	<option value='/blog/2008/05/'> May 2008 &nbsp;(1)</option>
	<option value='/blog/2008/03/'> March 2008 &nbsp;(1)</option>
	<option value='/blog/2008/02/'> February 2008 &nbsp;(3)</option>
	<option value='/blog/2007/12/'> December 2007 &nbsp;(1)</option>
	<option value='/blog/2007/11/'> November 2007 &nbsp;(1)</option>
	<option value='/blog/2007/10/'> October 2007 &nbsp;(2)</option>
	<option value='/blog/2007/09/'> September 2007 &nbsp;(1)</option>
	<option value='/blog/2007/08/'> August 2007 &nbsp;(3)</option>
	<option value='/blog/2007/07/'> July 2007 &nbsp;(3)</option>
	<option value='/blog/2007/06/'> June 2007 &nbsp;(3)</option>
	<option value='/blog/2007/05/'> May 2007 &nbsp;(3)</option>
	<option value='/blog/2007/04/'> April 2007 &nbsp;(4)</option>
	<option value='/blog/2007/03/'> March 2007 &nbsp;(4)</option>
	<option value='/blog/2007/02/'> February 2007 &nbsp;(9)</option>
	<option value='/blog/2007/01/'> January 2007 &nbsp;(2)</option>
	<option value='/blog/2006/12/'> December 2006 &nbsp;(14)</option>
	<option value='/blog/2006/11/'> November 2006 &nbsp;(13)</option>
	<option value='/blog/2006/10/'> October 2006 &nbsp;(17)</option>
	<option value='/blog/2006/09/'> September 2006 &nbsp;(17)</option>
	<option value='/blog/2006/08/'> August 2006 &nbsp;(3)</option>
	<option value='/blog/2006/07/'> July 2006 &nbsp;(1)</option>
	<option value='/blog/2001/04/'> April 2001 &nbsp;(1)</option>
 </select>
</div><div id="search-3" class="clearfix widget widget_search"><form method="get" id="searchfield" action="/blog/">
	<input name="s" type="text" onfocus="if ( this.value=='Search' ) this.value='';" onblur="if ( this.value=='' ) this.value='Search';" value="Search" />
</form>
</div>	</div><!-- #third .widget-area -->
	</div><!-- #widgets -->			<!--<p class="info-theme" role="contentinfo"><a href="http://wordpress.org/" rel="generator">Proudly powered by WordPress</a><span class="sep"> | </span>Theme: Pink Touch 2 by <a href="http://automattic.com/" rel="designer">Automattic</a>.</p>-->
		</div>
	</div>


</body>
</html>
